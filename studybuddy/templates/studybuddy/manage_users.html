{% extends "studybuddy/base.html" %}

{% block content %}

<h2>Manage Users</h2>

{% if messages %}
  {% for message in messages %}
    <p style="color: green;">{{ message }}</p>
  {% endfor %}
{% endif %}

<table border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th>Username</th>
      <th>Email</th>
      <th>Staff</th>
      <th>Active</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for user in users %}
      <tr>
        <td>{{ user.username }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.is_staff }}</td>
        <td>{{ user.is_active }}</td>
        <td>
          <!-- Block / Unblock button -->
          {% if user.is_active %}
            <form method="post" action="{% url 'studybuddy:block_user' user.id %}" style="display:inline;">
              {% csrf_token %}
              <button type="submit">Block</button>
            </form>
          {% else %}
            <form method="post" action="{% url 'studybuddy:unblock_user' user.id %}" style="display:inline;">
              {% csrf_token %}
              <button type="submit">Unblock</button>
            </form>
          {% endif %}

          <!-- Delete button -->
          <form method="post" action="{% url 'studybuddy:delete_user' user.id %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" onclick="return confirm('Are you sure you want to delete this user?');">Delete</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
